<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© - Ø§Ù„Ù…Ø¯ÙˆÙ†Ø©</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="styles.css">
  <style>
    body { font-family: "Cairo", sans-serif; background:#0b1220; color:#eee; padding:20px; }
    .box { max-width:600px; margin:20px auto; background:#111827; padding:20px; border-radius:10px; }
    input, textarea { width:100%; margin:8px 0; padding:10px; border-radius:6px; border:none; }
    button { padding:10px 15px; border:none; border-radius:6px; background:#22d3ee; cursor:pointer; }
    .hidden { display:none; }
  </style>
</head>
<body>
  <h1>ğŸ”‘ Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</h1>

  <!-- Ø´Ø§Ø´Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ -->
  <div id="loginBox" class="box">
    <h3>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h3>
    <input type="password" id="password" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±">
    <button onclick="login()">Ø¯Ø®ÙˆÙ„</button>
    <p id="msg" style="color:red"></p>
  </div>

  <!-- Ø´Ø§Ø´Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© -->
  <div id="adminBox" class="box hidden">
    <h3>Ø¥Ø¶Ø§ÙØ© / ØªØ¹Ø¯ÙŠÙ„ Ù…Ù‚Ø§Ù„</h3>
    <input id="title" placeholder="Ø§Ù„Ø¹Ù†ÙˆØ§Ù†">
    <textarea id="content" rows="5" placeholder="Ø§Ù„Ù…Ø­ØªÙˆÙ‰"></textarea>
    <input id="tags" placeholder="Ø§Ù„ÙˆØ³ÙˆÙ… (Ø§ÙØµÙ„ Ø¨ÙÙˆØ§ØµÙ„)">
    <input id="cover" placeholder="Ø±Ø§Ø¨Ø· ØµÙˆØ±Ø© Ø§Ù„ØºÙ„Ø§Ù (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)">
    <p>Ø£Ùˆ Ø§Ø®ØªØ± ØµÙˆØ±Ø© ØºÙ„Ø§Ù:</p>
    <input type="file" id="coverFile" accept="image/*">
    <button onclick="addArticle()">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ù…Ù‚Ø§Ù„</button>

    <hr>
    <h3>ØªØ­Ø¯ÙŠØ« Ø³Ø·Ø± Ø§Ù„ØªØ¹Ø±ÙŠÙ</h3>
    <input id="tagline" placeholder="Ø³Ø·Ø± Ø§Ù„ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø¬Ø¯ÙŠØ¯">
    <button onclick="updateTagline()">ØªØ­Ø¯ÙŠØ«</button>

    <hr>
    <h3>ØªØºÙŠÙŠØ± ØµÙˆØ±Ø© Ø§Ù„Ø¨Ø±ÙˆÙØ§ÙŠÙ„</h3>
    <input type="file" id="profileFile" accept="image/*">
    <button onclick="updateProfile()">Ø±ÙØ¹ Ø§Ù„ØµÙˆØ±Ø©</button>
  </div>

  <script>
    const API = "https://pro-blog-api.onrender.com"; // Ø¹Ø¯Ù„ Ù„Ø±Ø§Ø¨Ø· Render ØªØ¨Ø¹Ùƒ
    const ADMIN_PASS = "0598306258"; // ØºÙŠÙ‘Ø±Ù‡Ø§ Ù„ÙƒÙ„Ù…Ø© Ø³Ø± Ø®Ø§ØµØ© ÙÙŠÙƒ

    function login(){
      const pass = document.getElementById("password").value;
      if(pass === ADMIN_PASS){
        document.getElementById("loginBox").classList.add("hidden");
        document.getElementById("adminBox").classList.remove("hidden");
      }else{
        document.getElementById("msg").innerText = "âŒ ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± Ø®Ø§Ø·Ø¦Ø©";
      }
    }

    async function uploadFile(file){
      const form = new FormData();
      form.append("file", file);
      const res = await fetch(API+"/upload", {method:"POST", body:form});
      if(res.ok){
        const data = await res.json();
        return data.url; // Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø©
      }else{
        alert("Ø®Ø·Ø£ ÙÙŠ Ø±ÙØ¹ Ø§Ù„ØµÙˆØ±Ø©");
        return null;
      }
    }

    async function addArticle(){
      const title = document.getElementById("title").value;
      const content = document.getElementById("content").value;
      const tags = document.getElementById("tags").value.split(",");
      let cover = document.getElementById("cover").value;

      // Ø¥Ø°Ø§ Ø§Ø®ØªØ§Ø± ØµÙˆØ±Ø© Ù…Ù„ÙØŒ Ù†Ø±ÙØ¹Ù‡Ø§
      const file = document.getElementById("coverFile").files[0];
      if(file){
        const url = await uploadFile(file);
        if(url) cover = url;
      }

      if(!title){ alert("Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ù…Ø·Ù„ÙˆØ¨"); return; }

      const res = await fetch(API+"/articles", {
        method:"POST",
        headers:{"Content-Type":"application/json"},
        body:JSON.stringify({title, content, tags, cover})
      });
      if(res.ok){ alert("âœ… ØªÙ… Ø­ÙØ¸ Ø§Ù„Ù…Ù‚Ø§Ù„"); }
    }

    async function updateTagline(){
      const tagline = document.getElementById("tagline").value;
      const res = await fetch(API+"/settings", {
        method:"PUT",
        headers:{"Content-Type":"application/json"},
        body:JSON.stringify({tagline})
      });
      if(res.ok){ alert("âœ… ØªÙ… ØªØ­Ø¯ÙŠØ« Ø³Ø·Ø± Ø§Ù„ØªØ¹Ø±ÙŠÙ"); }
    }

    async function updateProfile(){
      const file = document.getElementById("profileFile").files[0];
      if(!file){ alert("Ø§Ø®ØªØ± ØµÙˆØ±Ø© Ø£ÙˆÙ„Ø§Ù‹"); return; }
      const url = await uploadFile(file);
      if(url){
        const res = await fetch(API+"/settings", {
          method:"PUT",
          headers:{"Content-Type":"application/json"},
          body:JSON.stringify({profile:url})
        });
        if(res.ok){ alert("âœ… ØªÙ… ØªØ­Ø¯ÙŠØ« ØµÙˆØ±Ø© Ø§Ù„Ø¨Ø±ÙˆÙØ§ÙŠÙ„"); }
      }
    }
  </script>
</body>
</html>